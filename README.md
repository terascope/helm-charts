# terascope helm chart repository

## Overview

This repository holds helm charts useful for running services for [teraslice](https://github.com/terascope/teraslice).

## Documentation

- <https://terascope.github.io/helm-charts/>

```bash
helm repo add terascope https://terascope.github.io/helm-charts/
helm repo update
```

## Development

### Hooks

This repo requires the following tools to perform pre-commit hooks:

- `husky`
  - run `npx husky install` from this repo. This will link the `husky` pre-commit hook file to `git`.
  - docs: <https://typicode.github.io/husky/>
- `ct lint`
  - install on mac with `brew install chart-testing`
  - docs: <https://github.com/helm/chart-testing>
- `helm-docs`
  - install on mac with `brew install norwoodj/tap/helm-docs`
  - docs: <https://github.com/norwoodj/helm-docs>

To skip pre-commit hooks use `-n/--no-verify`

```bash
git commit -m "..." -n
```

To disable husky hooks completely:

```bash
export HUSKY=0 # Disables all Git hooks
git ...
git ...
unset HUSKY # Re-enables hooks
```

### How to update the chart README files

Chart README files are autogenerated from the `README.md.gotmpl` template using `helm-docs`. Any changes to README.md will be overwritten. Modify the template directly. The table of `Values` is generated from the `values.yaml`. To add a description to the table for a given key, prefix the first line of the description with `# --` on a line above the key. Subsequent lines need only a `#`. To override the default value for a key prefix with `# @default --`. To  not include a key in the table use `# @ignore`. Any update to `values.yaml` will require an update to the docs with this command: `helm-docs --sort-values-order=file`.

### CI values.yaml

The `ci/ci-values.yaml` file is designed to enable all optional functionality in the helm chart, allowing `kubeconform` to validate all possible manifest files. When adding optional resources to a chart make sure to update this file.
